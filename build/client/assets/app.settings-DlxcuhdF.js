import{r as a,j as e}from"./index-BXFZJKZ8.js";import{a as f,d as y}from"./components-B2MXwJ-S.js";import{P as h,B as r,C as x,T as i,b as j}from"./Page-D9pdNdHS.js";import{T as b}from"./TitleBar-DFMSJ8Yc.js";import{L as u}from"./Layout-BW6TgK73.js";import{B as g}from"./Banner-BiM8hRvP.js";import"./context-BusKBsRw.js";import"./banner-context-RZ1829w2.js";function E(){const c=f(),[d,l]=a.useState(!1),[s,o]=a.useState(null),t=y();a.useEffect(()=>{t&&"resync"in t&&(l(!1),o(t.resync))},[t]);const p=a.useCallback(()=>{l(!0),o(null);const n=new FormData;n.append("intent","resync_discounts"),c(n,{method:"post"})},[c]);return e.jsxs(h,{children:[e.jsx(b,{title:"Settings"}),e.jsx(r,{gap:"500",children:e.jsx(u,{children:e.jsx(u.AnnotatedSection,{title:"Operational Re-sync",description:"Re-sync consolidated discount config and product metafields consumed by your theme.",children:e.jsx(x,{children:e.jsxs(r,{gap:"400",children:[e.jsx(i,{as:"p",variant:"bodyMd",children:"This refreshes the single consolidated Shopify discount node and rebuilds product-level bundle metafields."}),s&&e.jsx(g,{tone:s.failed>0?"critical":"success",onDismiss:()=>o(null),children:e.jsxs(r,{gap:"200",children:[e.jsxs(i,{as:"p",variant:"bodyMd",children:["Re-sync complete: ",s.created,"/",s.total," bundles synced",s.failed>0?` (${s.failed} failed)`:" successfully.","."]}),"productsSynced"in s&&e.jsxs(i,{as:"p",variant:"bodyMd",children:["Product metafields refreshed for approximately ",s.productsSynced," bundle item references."]}),s.errors&&s.errors.length>0&&e.jsx(r,{gap:"100",children:s.errors.map((n,m)=>e.jsx(i,{as:"p",variant:"bodySm",tone:"critical",children:n},m))})]})}),e.jsx(j,{onClick:p,loading:d,disabled:d,children:"Re-sync Theme + Discounts"})]})})})})})]})}export{E as default};
